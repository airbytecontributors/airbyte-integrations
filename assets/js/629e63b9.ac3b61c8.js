"use strict";(self.webpackChunkdocu=self.webpackChunkdocu||[]).push([[9028],{3905:function(t,e,r){r.d(e,{Zo:function(){return p},kt:function(){return d}});var a=r(67294);function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach((function(e){o(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e){if(null==t)return{};var r,a,o=function(t,e){if(null==t)return{};var r,a,o={},n=Object.keys(t);for(a=0;a<n.length;a++)r=n[a],e.indexOf(r)>=0||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);for(a=0;a<n.length;a++)r=n[a],e.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(t,r)&&(o[r]=t[r])}return o}var l=a.createContext({}),u=function(t){var e=a.useContext(l),r=e;return t&&(r="function"==typeof t?t(e):i(i({},e),t)),r},p=function(t){var e=u(t.components);return a.createElement(l.Provider,{value:e},t.children)},c={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},m=a.forwardRef((function(t,e){var r=t.components,o=t.mdxType,n=t.originalType,l=t.parentName,p=s(t,["components","mdxType","originalType","parentName"]),m=u(r),d=o,f=m["".concat(l,".").concat(d)]||m[d]||c[d]||n;return r?a.createElement(f,i(i({ref:e},p),{},{components:r})):a.createElement(f,i({ref:e},p))}));function d(t,e){var r=arguments,o=e&&e.mdxType;if("string"==typeof t||o){var n=r.length,i=new Array(n);i[0]=m;var s={};for(var l in e)hasOwnProperty.call(e,l)&&(s[l]=e[l]);s.originalType=t,s.mdxType="string"==typeof t?t:o,i[1]=s;for(var u=2;u<n;u++)i[u]=r[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,r)}m.displayName="MDXCreateElement"},5272:function(t,e,r){r.r(e),r.d(e,{assets:function(){return p},contentTitle:function(){return l},default:function(){return d},frontMatter:function(){return s},metadata:function(){return u},toc:function(){return c}});var a=r(87462),o=r(63366),n=(r(67294),r(3905)),i=["components"],s={},l="Transformations with Airbyte (Part 3/3)",u={unversionedId:"operator-guides/transformation-and-normalization/transformations-with-airbyte",id:"operator-guides/transformation-and-normalization/transformations-with-airbyte",title:"Transformations with Airbyte (Part 3/3)",description:"Overview",source:"@site/../docs/operator-guides/transformation-and-normalization/transformations-with-airbyte.md",sourceDirName:"operator-guides/transformation-and-normalization",slug:"/operator-guides/transformation-and-normalization/transformations-with-airbyte",permalink:"/operator-guides/transformation-and-normalization/transformations-with-airbyte",draft:!1,editUrl:"https://github.com/airbytehq/airbyte/blob/master/docs/../docs/operator-guides/transformation-and-normalization/transformations-with-airbyte.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"Transformations with dbt (Part 2/3)",permalink:"/operator-guides/transformation-and-normalization/transformations-with-dbt"},next:{title:"Configuring Airbyte",permalink:"/operator-guides/configuring-airbyte"}},p={},c=[{value:"Overview",id:"overview",level:2},{value:"Transformations with Airbyte",id:"transformations-with-airbyte",level:2},{value:"Public Git repository",id:"public-git-repository",level:2},{value:"Private Git repository",id:"private-git-repository",level:2},{value:"Example of a private git repo used as transformations",id:"example-of-a-private-git-repo-used-as-transformations",level:3},{value:"How-to use custom dbt tips",id:"how-to-use-custom-dbt-tips",level:2},{value:"Refresh models partially",id:"refresh-models-partially",level:3},{value:"Using a custom run with variables",id:"using-a-custom-run-with-variables",level:3}],m={toc:c};function d(t){var e=t.components,s=(0,o.Z)(t,i);return(0,n.kt)("wrapper",(0,a.Z)({},m,s,{components:e,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"transformations-with-airbyte-part-33"},"Transformations with Airbyte (Part 3/3)"),(0,n.kt)("h2",{id:"overview"},"Overview"),(0,n.kt)("p",null,"This tutorial will describe how to push a custom dbt transformation project back to Airbyte to use during syncs."),(0,n.kt)("p",null,"This guide is the last part of the tutorial series on transformations, following ",(0,n.kt)("a",{parentName:"p",href:"/operator-guides/transformation-and-normalization/transformations-with-sql"},"Transformations with SQL")," and ",(0,n.kt)("a",{parentName:"p",href:"/operator-guides/transformation-and-normalization/transformations-with-dbt"},"connecting EL with T using dbt"),"."),(0,n.kt)("p",null,"(","Example outputs are updated with Airbyte version 0.23.0-alpha from May 2021",")"),(0,n.kt)("h2",{id:"transformations-with-airbyte"},"Transformations with Airbyte"),(0,n.kt)("p",null,"After replication of data from a source connector ","(","Extract",")"," to a destination connector ","(","Load",")",", multiple optional transformation steps can now be applied as part of an Airbyte Sync. Possible workflows are:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Basic normalization transformations as automatically generated by Airbyte dbt code generator."),(0,n.kt)("li",{parentName:"ol"},"Customized normalization transformations as edited by the user ","(","the default generated normalization one should therefore be disabled",")"),(0,n.kt)("li",{parentName:"ol"},"Customized business transformations as specified by the user.")),(0,n.kt)("h2",{id:"public-git-repository"},"Public Git repository"),(0,n.kt)("p",null,"In the connection settings page, I can add new Transformations steps to apply after ",(0,n.kt)("a",{parentName:"p",href:"/understanding-airbyte/basic-normalization"},"normalization"),". For example, I want to run my custom dbt project jaffle_shop, whenever my sync is done replicating and normalizing my data."),(0,n.kt)("p",null,"You can find the jaffle shop test repository by clicking ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/dbt-labs/jaffle_shop"},"here"),"."),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(59839).Z,width:"1114",height:"452"})),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(47243).Z,width:"1128",height:"357"})),(0,n.kt)("h2",{id:"private-git-repository"},"Private Git repository"),(0,n.kt)("p",null,"Now, let's connect my mono-repo Business Intelligence project stored in a private git repository to update the related tables and dashboards when my Airbyte syncs complete."),(0,n.kt)("p",null,"Note that if you need to connect to a private git repository, the recommended way to do so is to generate a ",(0,n.kt)("inlineCode",{parentName:"p"},"Personal Access Token")," that can be used instead of a password. Then, you'll be able to include the credentials in the git repository url:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.github.com/en/github/authenticating-to-github/keeping-your-account-and-data-secure/creating-a-personal-access-token"},"GitHub - Personal Access Tokens")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html"},"Gitlab - Personal Access Tokens")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://docs.microsoft.com/en-us/azure/devops/organizations/accounts/use-personal-access-tokens-to-authenticate"},"Azure DevOps - Personal Access Tokens"))),(0,n.kt)("p",null,"And then use it for cloning:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-text"},"git clone https://username:token@github.com/user/repo\n")),(0,n.kt)("p",null,"Where ",(0,n.kt)("inlineCode",{parentName:"p"},"https://username:token@github.com/user/repo")," is the git repository url."),(0,n.kt)("h3",{id:"example-of-a-private-git-repo-used-as-transformations"},"Example of a private git repo used as transformations"),(0,n.kt)("p",null,"As an example, I go through my GitHub account to generate a Personal Access Token to use in Airbyte with permissions to clone my private repositories:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(53765).Z,width:"1442",height:"755"})),(0,n.kt)("p",null,"This provides me with a token to use:"),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(72591).Z,width:"1459",height:"356"})),(0,n.kt)("p",null,"In Airbyte, I can use the git url as: ",(0,n.kt)("inlineCode",{parentName:"p"},"https://airbyteuser:ghp_***********ShLrG2yXGYF@github.com/airbyteuser/private-datawarehouse.git")),(0,n.kt)("p",null,(0,n.kt)("img",{src:r(90160).Z,width:"1112",height:"451"})),(0,n.kt)("h2",{id:"how-to-use-custom-dbt-tips"},"How-to use custom dbt tips"),(0,n.kt)("h3",{id:"refresh-models-partially"},"Refresh models partially"),(0,n.kt)("p",null,"Since I am using a mono-repo from my organization, other team members or departments may also contribute their dbt models to this centralized location. This will give us many dbt models and sources to build our complete data warehouse..."),(0,n.kt)("p",null,"The whole warehouse is scheduled for full refresh on a different orchestration tool, or as part of the git repository CI. However, here, I want to partially refresh some small relevant tables when attaching this operation to a specific Airbyte sync, in this case, the Covid dataset."),(0,n.kt)("p",null,'Therefore, I can restrict the execution of models to a particular tag or folder by specifying in the dbt cli arguments, in this case whatever is related to "covid',"_",'api":'),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-text"},"run --models tag:covid_api opendata.base.*\n")),(0,n.kt)("p",null,"Now, when replications syncs are triggered by Airbyte, my custom transformations from my private git repository are also run at the end!"),(0,n.kt)("h3",{id:"using-a-custom-run-with-variables"},"Using a custom run with variables"),(0,n.kt)("p",null,"If you want to use a custom run and pass variables you need to use the follow syntax:"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'run --vars \'{table_name":"sample","schema_name":"other_value"}\'\n')),(0,n.kt)("p",null,"This string must have no space. There is a ",(0,n.kt)("a",{parentName:"p",href:"https://github.com/airbytehq/airbyte/issues/4348"},"Github issue")," to improve this. If you want to contribute to Airbyte, this is a good opportunity!"))}d.isMDXComponent=!0},72591:function(t,e,r){e.Z=r.p+"assets/images/copy-personal-token-241b9ab1b2f7dc853f08117d37daf76f.png"},59839:function(t,e,r){e.Z=r.p+"assets/images/custom-dbt-transformations-seed-7462c6c15e9ef604db7581bba92cee10.png"},47243:function(t,e,r){e.Z=r.p+"assets/images/custom-dbt-transformations-5490c1edd287961acd47375957288af7.png"},53765:function(t,e,r){e.Z=r.p+"assets/images/new-personal-token-5cb2ca495919d1aee221dff31594ca72.png"},90160:function(t,e,r){e.Z=r.p+"assets/images/setup-custom-transformation-d684dd61ea0757fcf3fb2e8dd72b74fb.png"}}]);