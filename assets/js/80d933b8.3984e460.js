"use strict";(self.webpackChunkdocu=self.webpackChunkdocu||[]).push([[7323],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(l,".").concat(m)]||d[m]||p[m]||i;return n?r.createElement(h,o(o({ref:t},u),{},{components:n})):r.createElement(h,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var c=2;c<i;c++)o[c]=n[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},88118:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return l},default:function(){return m},frontMatter:function(){return s},metadata:function(){return c},toc:function(){return p}});var r=n(87462),a=n(63366),i=(n(67294),n(3905)),o=["components"],s={},l="Change Data Capture (CDC)",c={unversionedId:"understanding-airbyte/cdc",id:"understanding-airbyte/cdc",title:"Change Data Capture \\(CDC\\)",description:"What is log-based incremental replication?",source:"@site/../docs/understanding-airbyte/cdc.md",sourceDirName:"understanding-airbyte",slug:"/understanding-airbyte/cdc",permalink:"/understanding-airbyte/cdc",editUrl:"https://github.com/airbytehq/airbyte/blob/gitbook/v1/README.md/../docs/understanding-airbyte/cdc.md",tags:[],version:"current",frontMatter:{},sidebar:"mySidebar",previous:{title:"Technical Stack",permalink:"/understanding-airbyte/tech-stack"},next:{title:"Namespaces",permalink:"/understanding-airbyte/namespaces"}},u={},p=[{value:"What is log-based incremental replication?",id:"what-is-log-based-incremental-replication",level:2},{value:"Syncing",id:"syncing",level:2},{value:"Limitations",id:"limitations",level:2},{value:"Current Support",id:"current-support",level:2},{value:"Coming Soon",id:"coming-soon",level:2}],d={toc:p};function m(e){var t=e.components,n=(0,a.Z)(e,o);return(0,i.kt)("wrapper",(0,r.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"change-data-capture-cdc"},"Change Data Capture ","(","CDC",")"),(0,i.kt)("h2",{id:"what-is-log-based-incremental-replication"},"What is log-based incremental replication?"),(0,i.kt)("p",null,"Many common databases support writing all record changes to log files for the purpose of replication. A consumer of these log files ","(","such as Airbyte",")"," can read these logs while keeping track of the current position within the logs in order to read all record changes coming from ",(0,i.kt)("inlineCode",{parentName:"p"},"DELETE"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"INSERT"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"UPDATE")," statements."),(0,i.kt)("h2",{id:"syncing"},"Syncing"),(0,i.kt)("p",null,"The orchestration for syncing is similar to non-CDC database sources. After selecting a sync interval, syncs are launched regularly. We read data from the log up to the time that the sync was started. We do not treat CDC sources as infinite streaming sources. You should ensure that your schedule for running these syncs is frequent enough to consume the logs that are generated. The first time the sync is run, a snapshot of the current state of the data will be taken. This is done using ",(0,i.kt)("inlineCode",{parentName:"p"},"SELECT")," statements and is effectively a Full Refresh. Subsequent syncs will use the logs to determine which changes took place since the last sync and update those. Airbyte keeps track of the current log position between syncs."),(0,i.kt)("p",null,"A single sync might have some tables configured for Full Refresh replication and others for Incremental. If CDC is configured at the source level, all tables with Incremental selected will use CDC. All Full Refresh tables will replicate using the same process as non-CDC sources. However, these tables will still include CDC metadata columns by default."),(0,i.kt)("p",null,"The Airbyte Protocol outputs records from sources. Records from ",(0,i.kt)("inlineCode",{parentName:"p"},"UPDATE")," statements appear the same way as records from ",(0,i.kt)("inlineCode",{parentName:"p"},"INSERT")," statements. We support different options for how to sync this data into destinations using primary keys, so you can choose to append this data, delete in place, etc."),(0,i.kt)("p",null,"We add some metadata columns for CDC sources:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ab_cdc_lsn")," ","(","postgres and sql server sources",")"," is the point in the log where the record was retrieved"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ab_cdc_log_file")," & ",(0,i.kt)("inlineCode",{parentName:"li"},"ab_cdc_log_pos")," ","(","specific to mysql source",")"," is the file name and position in the file where the record was retrieved"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ab_cdc_updated_at")," is the timestamp for the database transaction that resulted in this record change and is present for records from ",(0,i.kt)("inlineCode",{parentName:"li"},"DELETE"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"INSERT"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"UPDATE")," statements "),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"ab_cdc_deleted_at")," is the timestamp for the database transaction that resulted in this record change and is only present for records from ",(0,i.kt)("inlineCode",{parentName:"li"},"DELETE")," statements")),(0,i.kt)("h2",{id:"limitations"},"Limitations"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"CDC incremental is only supported for tables with primary keys. A CDC source can still choose to replicate tables without primary keys as Full Refresh or a non-CDC source can be configured for the same database to replicate the tables without primary keys using standard incremental replication."),(0,i.kt)("li",{parentName:"ul"},"Data must be in tables, not views."),(0,i.kt)("li",{parentName:"ul"},"The modifications you are trying to capture must be made using ",(0,i.kt)("inlineCode",{parentName:"li"},"DELETE"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"INSERT"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"UPDATE"),". For example, changes made from ",(0,i.kt)("inlineCode",{parentName:"li"},"TRUNCATE"),"/",(0,i.kt)("inlineCode",{parentName:"li"},"ALTER"),"  won't appear in logs and therefore in your destination."),(0,i.kt)("li",{parentName:"ul"},"We do not support schema changes automatically for CDC sources. We recommend resetting and resyncing data if you make a schema change."),(0,i.kt)("li",{parentName:"ul"},"There are database-specific limitations. See the documentation pages for individual connectors for more information."),(0,i.kt)("li",{parentName:"ul"},"The records produced by ",(0,i.kt)("inlineCode",{parentName:"li"},"DELETE")," statements only contain primary keys. All other data fields are unset.")),(0,i.kt)("h2",{id:"current-support"},"Current Support"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/integrations/sources/postgres"},"Postgres")," ","(","For a quick video overview of CDC on Postgres, click ",(0,i.kt)("a",{parentName:"li",href:"https://www.youtube.com/watch?v=NMODvLgZvuE&ab_channel=Airbyte"},"here"),")"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/integrations/sources/mysql"},"MySQL")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/integrations/sources/mssql"},"Microsoft SQL Server / MSSQL"))),(0,i.kt)("h2",{id:"coming-soon"},"Coming Soon"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Oracle DB"),(0,i.kt)("li",{parentName:"ul"},"Please ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/airbytehq/airbyte/issues/new/choose"},"create a ticket")," if you need CDC support on another database!")))}m.isMDXComponent=!0}}]);